const tackList = [
  {
    title: "Структура HTML-документа",
    chapter: "Теги",
    team: " ",
    link: `./Tacks/Tack1/TEST_1.html`,
  },
  {
    title: "Форматирование текста",
    chapter: "Теги",
    team: " ",
    link: `./Tacks/Tack1/TEST_2.html`,
  },
  {
    title: "Списки ",
    chapter: "Теги",
    team: " ",
    link: `./Tacks/Tack1/TEST_3.html`,
  },
  {
    title: "Размещение графики -1",
    chapter: "Теги",
    team: " ",
    link: "./Tacks/Tack1/TEST_4.html",
  },
  {
    title: "Размещение графики -2",
    chapter: "Теги",
    team: " ",
    link: "./Tacks/Tack1/TEST_5.html",
  },
  {
    title: "Гиперссылки",
    chapter: "Ссылки",
    team: " ",
    link: "./Tacks/Tack1/TEST_6.html",
  },
  {
    title: "Ссылки внутри документа",
    chapter: "Ссылки",
    team: "",
    link: "./Tacks/Tack1/TEST_7.html",
  },
  {
    title: "Элементы формы. Кнопка- 1",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_8.html",
  },
  {
    title: "Элементы формы. Кнопка- 2",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_9.html",
  },
  {
    title: "Элементы формы. Input",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_10.html",
  },
  {
    title: "Элементы формы select ",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_11.html",
  },

  {
    title: "Элементы формы Radiobutton",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_12.html",
  },
  {
    title: "Элементы формы CheckBox",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_13.html",
  },
  {
    title: "Валидация формы",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_14.html",
  },

  {
    title: "Валидация формы",
    chapter: "Форма",
    team: "",
    link: "./Tacks/Tack1/TEST_15.html",
  },

  {
    title: "Flexbox 1",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_16.html",
  },
  {
    title: "Flexbox 2",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_17.html",
  },
  {
    title: "Основы работы с сеткой. Grid",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_18.html",
  },
  {
    title: "Блоки Div- 1",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_19.html",
  },
  {
    title: "Блоки Div -2",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_20.html",
  },
  {
    title: "Блоки Div -3",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_21.html",
  },
  {
    title: "Таблицы- 1",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_22.html",
  },
  {
    title: "Таблицы -2",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_23.html",
  },
  {
    title: "Модель коробки (box model) margin, padding, border, width, height-1",
    chapter: "Верстка по размещению ",
    team: " ",
    link: "./Tacks/Tack1/TEST_24.html",
  },
  {
    title: "Модель коробки (box model) margin, padding, border, width, height-2",
    chapter: "Верстка по размещению ",
    team: "",
    link: "./Tacks/Tack1/TEST_25.html",
  },
  {
    title: "Модель коробки (box model) margin, padding, border, width, height-3",
    chapter: "Верстка по размещению ",
    team: "",
    link: "./Tacks/Tack1/TEST_26.html",
  },
  {
    title: "Фон",
    chapter: "Верстка по размещению ",
    team: "",
    link: "./Tacks/Tack1/TEST_27.html",
  },
   {
    title: "Позиционирование static, relative, absolute, fixed, sticky",
    chapter: "Верстка по размещению ",
    team: "",
    link: "./Tacks/Tack1/TEST_28.html",
  },
  {
    title: "Адаптивный и отзывчивый дизайн",
    chapter: "Верстка по размещению ",
    team: "",
    link: "./Tacks/Tack1/TEST_29.html",
  },
  {
    title: "Переменные, типы данных, операторы",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_30.html",
  },
  {
    title: "Условный оператор",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_31.html",
  },
  {
    title: "Циклы",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_32.html",
  },
  {
    title: "Функции",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_33.html",
  },
  {
    title: "Массивы",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_34.html",
  },
  {
    title: "Изменение элементов на странице",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_35.html",
  },
  {
    title: "Обработка событий",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_36.html",
  },
  {
    title: "Drag and Drop",
    chapter: "Js",
    team: "",
    link: "./Tacks/Tack1/TEST_37.html",
  },
  {
    title: "CSS -1",
    chapter: "Анимация",
    team: "",
    link: "./Tacks/Tack1/TEST_38.html",
  },
  {
    title: "CSS -2",
    chapter: "Анимация",
    team: "",
    link: "./Tacks/Tack1/TEST_39.html",
  },
  {
    title: "JS -1",
    chapter: "Анимация",
    team: "",
    link: "./Tacks/Tack1/TEST_40.html",
  },
  {
    title: "JS -2",
    chapter: "Анимация",
    team: "",
    link: "./Tacks/Tack1/TEST_41.html",
  },
  {
    title: "SVG -1",
    chapter: "Графика",
    team: "",
    link: "./Tacks/Tack1/TEST_42.html",
  },
  {
    title: "SVG -2",
    chapter: "Графика",
    team: "",
    link: "./Tacks/Tack1/TEST_43.html",
  },
  {
    title: "Canvas",
    chapter: "Графика",
    team: "",
    link: "./Tacks/Tack1/TEST_44.html",
  },
  {
    title: "Основы. Свойства и значения",
    chapter: "CSS",
    team: "",
    link: "./Tacks/Tack1/TEST_46.html",
  },
  {
    title: "Использование в оформлении",
    chapter: "CSS",
    team: "",
    link: "./Tacks/Tack1/TEST_47.html",
  },
  {
    title: "Псевдоклассы и псевдоэлементы ",
    chapter: "CSS",
    team: "",
    link: "./Tacks/Tack1/TEST_48.html",
  },
  {
    title: "Медиазапросы -1 ",
    chapter: "Адаптивность",
    team: "",
    link: "./Tacks/Tack1/TEST_49.html",
  },
  {
    title: "Медиазапросы -2 ",
    chapter: "Адаптивность",
    team: "",
    link: "./Tacks/Tack1/TEST_50.html",
  },















];

let visibleTackList = tackList;

const colorTeamBtn = document.querySelector(".color-team");

let teamUrl = new URL(document.location).searchParams;
let team = teamUrl.get("team");

let colorTeam = team

if (team == 'dark') {
	colorTeamBtn.checked = true
	document.body.classList.add("dark");
} else {
	document.body.classList.remove("dark");
}

colorTeamBtn.oninput = (()=> {
	if (colorTeamBtn.checked) {
		document.body.classList.add("dark");
		colorTeam = 'dark'
		menuTasks.innerHTML = ``
		renderTask(visibleTackList)
		return
	} 
	colorTeam = 'ligth'
	menuTasks.innerHTML = ``
	renderTask(visibleTackList)
	document.body.classList.remove("dark");
})

const menuChapter = document.querySelector(".content-tack__chapters");
const menuTasks = document.querySelector(".tacks");
const selectTeam = document.querySelector(".select-team");
const select = document.querySelector("select");

const renderChapter = (chapter) => {
  menuChapter.innerHTML += `
	<button class="chapter">${chapter.chapter}</button>
`;
};

const renderTask = (tacks) => {
  tacks.forEach((item) => {
    menuTasks.innerHTML += `
		<a href="${item.link}?team=${colorTeam}" class="tack">
			<h3 class="tack__title">${item.title}</h3>
			<p class="tack__chapter">${item.chapter}</p>
			<p class="tack__team">${item.team}</p>
		</a>
`;
  });
};

const renderTeam = (team) => {
  selectTeam.innerHTML += `
	<option>${team.team}</option>
`;
};

const tackchapter = [];
let tackteam = [];

const isSelectOption = () => {
  visibleTackList.forEach((item) => {
    if (tackteam.includes(item.team)) {
      return;
    }

    renderTeam(item);
    tackteam.push(item.team);
  });
};

tackList.forEach((item) => {
  if (tackchapter.includes(item.chapter)) {
    return;
  }

  renderChapter(item);
  tackchapter.push(item.chapter);
});
isSelectOption();

renderTask(visibleTackList);

const chapter = document.querySelectorAll(".chapter");

const removeBtn = () =>
  chapter.forEach((item) => item.classList.remove("active"));

chapter.forEach((btn) => {
  btn.addEventListener("click", () => {
    menuTasks.innerHTML = "";
    selectTeam.innerHTML = "<option>Все</option>";
    tackteam = [];
    removeBtn();
    if (btn.innerHTML == "Все") {
      visibleTackList = tackList;
      renderTask(visibleTackList);
      isSelectOption();
      btn.classList.add("active");
      return;
    }

    visibleTackList = [];
    tackteam = [];
    tackList.forEach((item) => {
      if (item.chapter == btn.innerHTML) {
        visibleTackList = [...visibleTackList, item];
      }
    });
    isSelectOption();
    renderTask(visibleTackList);
    btn.classList.add("active");
  });
});

const search = document.querySelector(".search-input");
const searchTacks = document.querySelector(".search-tacks__elements");

const renderSearchTack = (tacks) => {
  tacks.forEach((item) => {
    searchTacks.innerHTML += `
		<a href="${item.link}?team=${colorTeam}" class="search-tacks__element">
			<p class="search-tacks__element_title">${item.title}</p>
			<p class="search-tacks__element_chapter">${item.chapter}</p>
			<p class="search-tacks__element_team">${item.team}</p>
		</a>
`;
  });
};

const runSearch = (query) => {
  if (!query) {
    return null;
  }

  searchTacks.classList.remove("none");

  const lowerCaseQuery = query.toLowerCase();

  return visibleTackList.filter(
    (tack) =>
      tack.title
        .toLocaleLowerCase()
        .replaceAll(" ", "")
        .includes(lowerCaseQuery) ||
      tack.chapter
        .toLocaleLowerCase()
        .replaceAll(" ", "")
        .includes(lowerCaseQuery) ||
      tack.team.toLocaleLowerCase().replaceAll(" ", "").includes(lowerCaseQuery)
  );
};

search.addEventListener("input", (e) => {
  let query = e.target.value.replaceAll(" ", "");
  const foundTrask = runSearch(query);
  searchTacks.innerHTML = "";
  if (!query) {
    searchTacks.classList.add("none");
    return;
  }
  renderSearchTack(foundTrask);
});

select.addEventListener("change", (e) => {
  menuTasks.innerHTML = "";
  visibleTackList = tackList;
  let value = e.target.value;
  if (value === "Все") {
    renderTask(visibleTackList);
    return;
  }
  visibleTackList = [];
  tackList.forEach((item) => {
    item.team === value ? (visibleTackList = [...visibleTackList, item]) : null;
  });
  renderTask(visibleTackList);
});

const clearSearchBtn = document.querySelector(".search-tack__clear");
clearSearchBtn.addEventListener("click", () => {
  search.value = "";
  menuTasks.innerHTML = "";
  searchTacks.classList.add("none");
  renderTask(visibleTackList);
});
